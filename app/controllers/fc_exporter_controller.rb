# Dependencies to run the program
# 1> rmagick
# 2> json
require "RMagick" 
require 'rubygems'
require 'json'
class FcExporterController < ApplicationController
  
  def pageLoad
  	requestData = parseRequestParams(request.POST)
  	stream = '<svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" height="400" version="1.1" width="600"  id="raphael-paper-0" style="overflow: hidden; -webkit-tap-highlight-color: #000000; -webkit-user-select: none; cursor: default; position: relative; background-color: rgb(255, 255, 255);"><style type="text/css">.Fusioncharts-axis-labelssdfsd-xAxis { fontFamily: Verdana,sans;fontSize: 10px;lineHeight: 12px; };.fusioncharts-axis-xAxis { fontFamily: Verdana,sans;fontSize: 10px;lineHeight: 12px;fontWeight: bold;fontStyle: normal; };.Fusioncharts-axis-trendlines-label { fontFamily: Verdana,sans;fontSize: 10px;lineHeight: 12px;fontWeight: normal;fontStyle: normal; };.Fusioncharts-axis-labelssdfsd-yAxis { fontFamily: Verdana,sans;fontSize: 10px;lineHeight: 12px; };.fusioncharts-axis-yAxis { fontFamily: Verdana,sans;fontSize: 10px;lineHeight: 12px;fontWeight: bold;fontStyle: normal; };.fusioncharts-caption { fontFamily: Verdana,sans;color: #F7F3E7;fontSize: 13px;fontWeight: bold;lineHeight: 15.6px;fill: #F7F3E7; }</style><defs><linearGradient id="0-0-_E6E6E6-_E6E6E6_49-_bfbfbf_49-_bfbfbf_51-_FFFFFF_51-_FFFFFF" x1="0" y1="0" x2="1" y2="0"><stop offset="0%" stop-color="#e6e6e6" stop-opacity="1"></stop><stop offset="49%" stop-color="#e6e6e6" stop-opacity="1"></stop><stop offset="49%" stop-color="#bfbfbf" stop-opacity="1"></stop><stop offset="51%" stop-color="#bfbfbf" stop-opacity="1"></stop><stop offset="51%" stop-color="#ffffff" stop-opacity="1"></stop><stop offset="100%" stop-color="#ffffff" stop-opacity="1"></stop></linearGradient><clipPath id="36D4E838-2980-4565-A83B-C69C124CFB24"><rect x="44" y="46" width="539.5" height="304" transform="matrix(1,0,0,1,-44,-46)"></rect></clipPath><clipPath id="A70F4C98-7D48-479A-BCFC-EFC493E587B5"><rect x="44" y="46" width="539.5" height="304" transform="matrix(1,0,0,1,0,0)"></rect></clipPath><clipPath id="9924EE56-F159-41D6-AFDD-9A3504863A2E"><rect x="44" y="46" width="539.5" height="304" transform="matrix(1,0,0,1,0,0)"></rect></clipPath><clipPath id="50F5F74C-7C6C-4A8F-BD72-718504F80FB3"><rect x="44" y="46" width="539.5" height="304" transform="matrix(1,0,0,1,0,0)"></rect></clipPath><clipPath id="675DAF25-0F6D-4D77-9E40-DE8E5B347B88"><rect x="44" y="46" width="539.5" height="304" transform="matrix(1,0,0,1,0,0)"></rect></clipPath><clipPath id="7B7DF6C6-0E58-43D6-8043-8B8C8BD6F867"><rect x="44" y="350" width="539.5" height="50" transform="matrix(1,0,0,1,0,0)"></rect></clipPath><clipPath id="F227E2C9-C3D7-4AD3-AE05-0E6182F78811"><rect x="44" y="46" width="539.5" height="304" transform="matrix(1,0,0,1,0,0)"></rect></clipPath><clipPath id="836255DF-4903-4DE6-8C6D-F2EE36B4E601"><rect x="44" y="46" width="539.5" height="304" transform="matrix(1,0,0,1,0,0)"></rect></clipPath><clipPath id="70169C49-B02B-4BCD-B3BC-0D7CBD1503BA"><rect x="44" y="46" width="539.5" height="304" transform="matrix(1,0,0,1,0,0)"></rect></clipPath><clipPath id="8C170B18-5A09-49E6-A249-448D603AE968"><rect x="44" y="46" width="539.5" height="304" transform="matrix(1,0,0,1,0,0)"></rect></clipPath><clipPath id="9CCD75A6-B491-4F65-B2EA-2F8003AA46E7"><rect x="0" y="46" width="600" height="304" transform="matrix(1,0,0,1,0,0)"></rect></clipPath><clipPath id="DB3DA5EC-6E54-429C-A71E-2A32D15B155E"><rect x="44" y="46" width="539.5" height="304" transform="matrix(1,0,0,1,0,0)"></rect></clipPath></defs><g class="raphael-group-1-background"><rect x="1" y="1" width="598" height="398" stroke="none" fill-opacity="1" fill="#40526a" rx="0" ry="0" style="stroke: none; fill-opacity: 1; fill: rgb(64, 82, 106);"></rect><rect x="0.5" y="0.5" width="599" height="399" stroke="#767575" stroke-opacity="0.5" stroke-width="1" stroke-dasharray="none" fill="none" rx="0" ry="0" style="stroke: rgb(118, 117, 117); stroke-opacity: 0.5; fill: none;"></rect><rect x="0.5" y="0.5" opacity="1" stroke-opacity="1" fill="#cccccc" stroke-width="0" r="0" height="0.5" width="0.5" d="M 0 0 L 1 1" /></g><g class="raphael-group-14-canvas"><rect x="43.75" y="45.75" width="540" height="304.5" rx="0" ry="0" stroke-width="0.5" stroke="#ffffff" stroke-opacity="1" stroke-linejoin="miter" fill="none" style="stroke: rgb(255, 255, 255); stroke-opacity: 1; stroke-linejoin: miter; fill: none;"></rect><rect x="44" y="46" width="539.5" height="304" rx="0" ry="0" stroke-width="0" stroke="none" fill-opacity="0" fill="#ffffff" style="stroke: none; fill-opacity: 0; fill: rgb(255, 255, 255);"></rect><rect opacity="1" stroke-opacity="1" fill="#cccccc" stroke-width="0" r="0" height="0.5" width="0.5" d="M 0 0 L 1 1" /></g><g class="raphael-group-11-axis-bottom"><g class="raphael-group-40-dataset-Band-group"><g class="raphael-group-48-dataset-axis-bands" clip-path="url(\'#A70F4C98-7D48-479A-BCFC-EFC493E587B5\')"></g><g class="raphael-group-66-dataset-axis-bands" clip-path="url(\'#F227E2C9-C3D7-4AD3-AE05-0E6182F78811\')"></g></g><g class="raphael-group-41-dataset-Line-group"><g class="raphael-group-49-dataset-axis-lines" clip-path="url(\'#9924EE56-F159-41D6-AFDD-9A3504863A2E\')"><path d="M151.9,46L151.9,350" fill="none" stroke="#717170" stroke-opacity="0.4" stroke-width="1" stroke-dasharray="none" style="fill: none; stroke: rgb(113, 113, 112); stroke-opacity: 0.4;"></path><path opacity="1" stroke-opacity="1" fill="#cccccc" stroke-width="0" r="0" height="0.5" width="0.5" d="M 0 0 L 1 1" /><path d="M259.8,46L259.8,350" fill="none" stroke="#717170" stroke-opacity="0.4" stroke-width="1" stroke-dasharray="none" style="fill: none; stroke: rgb(113, 113, 112); stroke-opacity: 0.4;"></path><path opacity="1" stroke-opacity="1" fill="#cccccc" stroke-width="0" r="0" height="0.5" width="0.5" d="M 0 0 L 1 1" /><path d="M367.70000000000005,46L367.70000000000005,350" fill="none" stroke="#717170" stroke-opacity="0.4" stroke-width="1" stroke-dasharray="none" style="fill: none; stroke: rgb(113, 113, 112); stroke-opacity: 0.4;"></path><path opacity="1" stroke-opacity="1" fill="#cccccc" stroke-width="0" r="0" height="0.5" width="0.5" d="M 0 0 L 1 1" /><path d="M475.6,46L475.6,350" fill="none" stroke="#717170" stroke-opacity="0.4" stroke-width="1" stroke-dasharray="none" style="fill: none; stroke: rgb(113, 113, 112); stroke-opacity: 0.4;"></path><path opacity="1" stroke-opacity="1" fill="#cccccc" stroke-width="0" r="0" height="0.5" width="0.5" d="M 0 0 L 1 1" /></g><g class="raphael-group-67-dataset-axis-lines" clip-path="url(\'#836255DF-4903-4DE6-8C6D-F2EE36B4E601\')"><path d="M44,248.66666666666666L583.5,248.66666666666666" fill="none" stroke="#717170" stroke-opacity="1" stroke-width="1" stroke-dasharray="none" style="fill: none; stroke: rgb(113, 113, 112); stroke-opacity: 1;"></path><path d="M44,147.33333333333331L583.5,147.33333333333331" fill="none" stroke="#717170" stroke-opacity="1" stroke-width="1" stroke-dasharray="none" style="fill: none; stroke: rgb(113, 113, 112); stroke-opacity: 1;"></path></g></g><g class="raphael-group-42-dataset-Trend-group-bottom"><g class="raphael-group-51-dataset-axis-trend-bottom" clip-path="url(\'#675DAF25-0F6D-4D77-9E40-DE8E5B347B88\')"></g><g class="raphael-group-69-dataset-axis-trend-bottom" clip-path="url(\'#8C170B18-5A09-49E6-A249-448D603AE968\')"></g></g><g class="raphael-group-43-dataset-Name-group"><g class="raphael-group-53-dataset-axis-name"><text class="fusioncharts-axis-xAxis" x="313.75" y="377.5"  fill="#f7f3e7" stroke="#f7f3e7" stroke-width="0.2" text-anchor="middle" style=" fill: rgb(247, 243, 231); text-anchor: middle; fill-opacity: 1; font-size: 10px;" fill-opacity="1" stroke-opacity="1"  transform="matrix(1,0,0,1,0,0)" font-size="10px"><tspan dy="4" x="313.75">Time to respond (in minutes)</tspan></text></g><g class="raphael-group-71-dataset-axis-name"><text class="fusioncharts-axis-yAxis" x="22.5" y="198"  fill="#f7f3e7" stroke="#f7f3e7" stroke-width="0.2" text-anchor="middle" style=" fill: rgb(247, 243, 231); text-anchor: middle; fill-opacity: 1; font-size: 10px;" fill-opacity="1" stroke-opacity="1"  transform="matrix(0,-1,1,0,-175.5,220.5)" font-size="10px"><tspan dy="4" x="22.5">Customer Happiness</tspan></text></g></g><g class="raphael-group-44-dataset-Label-group"><g class="Fusioncharts-axis-labelssdfsd-xAxis"><text x="44" y="354.5"  fill="#f7f3e7" stroke="#f7f3e7" stroke-width="0.2" text-anchor="middle" style=" fill: rgb(247, 243, 231); text-anchor: middle; font-size: 10px;" font-size="10px"><tspan dy="9.5" x="44">0</tspan></text><text x="151.9" y="354.5"  fill="#f7f3e7" stroke="#f7f3e7" stroke-width="0.2" text-anchor="middle" style=" fill: rgb(247, 243, 231); text-anchor: middle; font-size: 10px;" font-size="10px"><tspan dy="9.5" x="151.9">6</tspan></text><text x="259.8" y="354.5"  fill="#f7f3e7" stroke="#f7f3e7" stroke-width="0.2" text-anchor="middle" style=" fill: rgb(247, 243, 231); text-anchor: middle; font-size: 10px;" font-size="10px"><tspan dy="9.5" x="259.8">12</tspan></text><text x="367.70000000000005" y="354.5"  fill="#f7f3e7" stroke="#f7f3e7" stroke-width="0.2" text-anchor="middle" style=" fill: rgb(247, 243, 231); text-anchor: middle; font-size: 10px;" font-size="10px"><tspan dy="9.5" x="367.70000000000005">18</tspan></text><text x="475.6" y="354.5"  fill="#f7f3e7" stroke="#f7f3e7" stroke-width="0.2" text-anchor="middle" style=" fill: rgb(247, 243, 231); text-anchor: middle; font-size: 10px;" font-size="10px"><tspan dy="9.5" x="475.6">24</tspan></text><text x="583.5" y="354.5"  fill="#f7f3e7" stroke="#f7f3e7" stroke-width="0.2" text-anchor="middle" style=" fill: rgb(247, 243, 231); text-anchor: middle; font-size: 10px;" font-size="10px"><tspan dy="9.5" x="583.5">30</tspan></text></g><g class="Fusioncharts-axis-labelssdfsd-yAxis"><text x="39.5" y="350" text-anchor="end"  fill="#f7f3e7" stroke="#f7f3e7" stroke-width="0.2" style="text-anchor: end;  fill: rgb(247, 243, 231); font-size: 10px;" font-size="10px"><tspan dy="3.5" x="39.5">0</tspan></text><text x="39.5" y="248.66666666666666" text-anchor="end"  fill="#f7f3e7" stroke="#f7f3e7" stroke-width="0.2" style="text-anchor: end;  fill: rgb(247, 243, 231); font-size: 10px;" font-size="10px"><tspan dy="3.510416666666657" x="39.5">3</tspan></text><text x="39.5" y="147.33333333333331" text-anchor="end"  fill="#f7f3e7" stroke="#f7f3e7" stroke-width="0.2" style="text-anchor: end;  fill: rgb(247, 243, 231); font-size: 10px;" font-size="10px"><tspan dy="3.5052083333333144" x="39.5">6</tspan></text><text x="39.5" y="46" text-anchor="end"  fill="#f7f3e7" stroke="#f7f3e7" stroke-width="0.2" style="text-anchor: end;  fill: rgb(247, 243, 231); font-size: 10px;" font-size="10px"><tspan dy="3.5" x="39.5">9</tspan></text></g></g><g class="raphael-group-46-axis-Line-group"></g></g><g class="raphael-group-2-dataset"><g class="raphael-group-17-dataset-orphan" transform="matrix(1,0,0,1,44,46)" clip-path="url(\'#36D4E838-2980-4565-A83B-C69C124CFB24\')" x="43.5" y="584"><g class="raphael-group-36-grid-container" transform="matrix(1,0,0,1,0,0)"><image preserveAspectRatio="none" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="temp/temp_image_0.png" x="0" y="0" width="539.5" height="304" /></g></g></g><g class="raphael-group-13-datalabels"></g><g class="raphael-group-12-axis-top"><g class="raphael-group-45-dataset-Trend-group-top"><g class="raphael-group-50-dataset-axis-trend-top" clip-path="url(\'#50F5F74C-7C6C-4A8F-BD72-718504F80FB3\')"></g><g class="raphael-group-52-dataset-axis-trend-label" clip-path="url(\'#7B7DF6C6-0E58-43D6-8043-8B8C8BD6F867\')"></g><g class="raphael-group-68-dataset-axis-trend-top" clip-path="url(\'#70169C49-B02B-4BCD-B3BC-0D7CBD1503BA\')"></g><g class="raphael-group-70-dataset-axis-trend-label" clip-path="url(\'#9CCD75A6-B491-4F65-B2EA-2F8003AA46E7\')"></g></g></g><g class="raphael-group-80-caption"><text class="fusioncharts-caption" fill="#f7f3e7" stroke="#f7f3e7" stroke-width="0.2" x="300" y="21" text-anchor="middle"  style="fill: rgb(247, 243, 231); text-anchor: middle;  font-family: verdana, sans; font-size: 13px; font-weight: bold;" font-family="Verdana,sans" font-size="13px" font-weight="bold"><tspan dy="12.8125" x="300">Customer Happiness by Response time</tspan></text></g><g class="raphael-group-3-hot"><rect x="44" y="46" width="539.5" height="304" rx="0" ry="0" fill="#c0c0c0" stroke="#c0c0c0" fill-opacity="0.000001" stroke-opacity="0.000001" style="fill: rgb(192, 192, 192); stroke: rgb(192, 192, 192); fill-opacity: 0.001; stroke-opacity: 0.001; cursor: default;"></rect><rect x="44" y="46" opacity="1" stroke-opacity="1" fill="#cccccc" stroke-width="0" r="0" height="0.5" width="0.5" d="M 0 0 L 1 1" /><circle cx="0" cy="0" r="0" fill="#c0c0c0" stroke="#c0c0c0" clip-path="url(\'#DB3DA5EC-6E54-429C-A71E-2A32D15B155E\')" fill-opacity="0.000001" stroke-opacity="0.000001" stroke-width="0" transform="matrix(1,0,0,1,0,0)" style="fill: rgb(192, 192, 192); stroke: rgb(192, 192, 192); fill-opacity: 0.001; stroke-opacity: 0.001;"></circle><circle opacity="1" stroke-opacity="1" fill="#cccccc" stroke-width="0" r="0" height="0.5" width="0.5" d="M 0 0 L 1 1" /></g><g class="raphael-group-6-buttons" style="display: none;"><g class="raphael-group-7-button"><rect x="572.5" y="6.5" width="18" height="17" rx="2" ry="2" fill="#ffffff" stroke="#c2c2c2" stroke-width="1" opacity="1" fill-opacity="1" style="stroke: rgb(194, 194, 194); opacity: 1; fill-opacity: 1; fill: rgb(255, 255, 255);"></rect><path d="M576.5,17.5L576.5,20.5L587.5,20.5L587.5,17.5L587.5,20.5L576.5,20.5ZM581.5,19.5L578.5,15L580.5,15L580.5,9.5L582.5,9.5L582.5,15L584.5,15Z" fill="#ffffff" stroke="#c2c2c2" stroke-width="1" style="fill: rgb(255, 255, 255); stroke: rgb(194, 194, 194);"></path><rect x="572.5" y="6.5" width="18" height="17" rx="2" ry="2" fill="#c0c0c0" stroke="#c0c0c0" fill-opacity="0.000001" stroke-opacity="0.000001" stroke-width="1" style="fill: rgb(192, 192, 192); stroke: rgb(192, 192, 192); fill-opacity: 0.001; stroke-opacity: 0.001; cursor: pointer;"></rect><rect x="572.5" y="6.5" opacity="1" stroke-opacity="1" fill="#cccccc" stroke-width="0" r="0" height="0.5" width="0.5" d="M 0 0 L 1 1" /></g><g class="raphael-group-19-button"><rect x="522.5" y="6.5" width="45" height="17" rx="2" ry="2" fill="url(\'#0-0-_E6E6E6-_E6E6E6_49-_bfbfbf_49-_bfbfbf_51-_FFFFFF_51-_FFFFFF\')" stroke="#bbbbbb" stroke-width="1" fill-opacity="1" stroke-opacity="1" opacity="1" style="stroke: rgb(187, 187, 187); fill-opacity: 1; stroke-opacity: 1; opacity: 1;"></rect><path d="M535.9160916572863,16.943992620281243A4.5,4.5,0,1,0,535.6360877286148,17.219151714648273ZM536.9160916572863,17.943992620281243L539.8935673014606,20.921468264455573L538.6135633727891,20.196627358822603L539.6135633727891,19.196627358822603L540.1135633727891,21.696627358822603L537.6135633727891,21.196627358822603L538.6135633727891,20.196627358822603L536.6360877286148,18.219151714648273ZM530.625,13.875L534.625,13.875ZM532.625,11.875L532.625,15.875ZM555.37109375,13.2421875L557.12890625,13.2421875L557.12890625,10.60546875L558.88671875,10.60546875L556.25,7.96875L553.61328125,10.60546875L555.37109375,10.60546875ZM557.12890625,13.681640625L560.64453125,14.12109375L560.64453125,12.36328125L563.28125,15L560.64453125,17.63671875L560.64453125,15.87890625L557.12890625,16.318359375ZM557.12890625,17.197265625L557.12890625,19.39453125L558.88671875,19.39453125L556.25,22.03125L553.61328125,19.39453125L555.37109375,19.39453125L555.37109375,17.197265625ZM554.4921875,14.12109375L551.85546875,14.12109375L551.85546875,12.36328125L549.21875,15L551.85546875,17.63671875L551.85546875,15.87890625L554.4921875,15.87890625Z" fill="url(\'#0-0-_E6E6E6-_E6E6E6_49-_bfbfbf_49-_bfbfbf_51-_FFFFFF_51-_FFFFFF\')" stroke="#9a9a9a" fill-opacity="1" stroke-opacity="1" stroke-width="1" opacity="1" style="stroke: rgb(154, 154, 154); fill-opacity: 1; stroke-opacity: 1; opacity: 1;"></path><rect x="522.5" y="6.5" width="45" height="17" rx="2" ry="2" fill="#c0c0c0" stroke="#c0c0c0" fill-opacity="0.000001" stroke-opacity="0.000001" stroke-width="1" style="fill: rgb(192, 192, 192); stroke: rgb(192, 192, 192); fill-opacity: 0.001; stroke-opacity: 0.001; cursor: pointer;"></rect><rect opacity="1" stroke-opacity="1" fill="#cccccc" stroke-width="0" r="0" height="0.5" width="0.5" d="M 0 0 L 1 1" /></g><path d="M516.75,5V26" fill="none" stroke="#cccccc" stroke-width="1" style="fill: none; stroke: rgb(204, 204, 204);"></path><g class="raphael-group-24-button" stroke-opacity="1" style="stroke-opacity: 1;"><rect x="492.5" y="6.5" width="18" height="17" rx="2" ry="2" fill="#ffffff" stroke="#e3e3e3" stroke-width="1" fill-opacity="1" style="fill: rgb(255, 255, 255); stroke: rgb(227, 227, 227); fill-opacity: 1;"></rect><path d="M495.875,9.375H507.125V20.625H495.875V9.375Z" fill="#ffffff" stroke="#e3e3e3" fill-opacity="1" stroke-width="1" style="fill: rgb(255, 255, 255); stroke: rgb(227, 227, 227); fill-opacity: 1;"></path><rect x="492.5" y="6.5" width="18" height="17" rx="2" ry="2" fill="#c0c0c0" stroke="#c0c0c0" fill-opacity="0.000001" stroke-opacity="0.000001" stroke-width="1" style="fill: rgb(192, 192, 192); stroke: rgb(192, 192, 192); fill-opacity: 0.001; stroke-opacity: 0.001; cursor: pointer;"></rect><rect x="492.5" y="6.5" opacity="1" stroke-opacity="1" fill="#cccccc" stroke-width="0" r="0" height="0.5" width="0.5" d="M 0 0 L 1 1" /></g><g class="raphael-group-28-button" stroke-opacity="1" style="stroke-opacity: 1;"><rect x="469.5" y="6.5" width="18" height="17" rx="2" ry="2" fill="#ffffff" stroke="#e3e3e3" stroke-width="1" fill-opacity="1" style="fill: rgb(255, 255, 255); stroke: rgb(227, 227, 227); fill-opacity: 1;"></rect><path d="M472.875,9.375H484.125V20.625H472.875V9.375Z" fill="#ffffff" stroke="#e3e3e3" fill-opacity="1" stroke-width="1" style="fill: rgb(255, 255, 255); stroke: rgb(227, 227, 227); fill-opacity: 1;"></path><rect x="469.5" y="6.5" width="18" height="17" rx="2" ry="2" fill="#c0c0c0" stroke="#c0c0c0" fill-opacity="0.000001" stroke-opacity="0.000001" stroke-width="1" style="fill: rgb(192, 192, 192); stroke: rgb(192, 192, 192); fill-opacity: 0.001; stroke-opacity: 0.001; cursor: pointer;"></rect><rect opacity="1" stroke-opacity="1" fill="#cccccc" stroke-width="0" r="0" height="0.5" width="0.5" d="M 0 0 L 1 1" /></g><g class="raphael-group-32-button" stroke-opacity="1" style="stroke-opacity: 1;"><rect x="446.5" y="6.5" width="18" height="17" rx="2" ry="2" fill="#ffffff" stroke="#c2c2c2" stroke-width="1" style="fill: rgb(255, 255, 255); stroke: rgb(194, 194, 194);"></rect><path d="M457.66609165728624,16.943992620281243A4.5,4.5,0,1,0,457.3860877286149,17.219151714648273ZM458.66609165728624,17.943992620281243L461.64356730146056,20.921468264455573L460.3635633727892,20.196627358822603L458.3860877286149,18.219151714648273ZM452.375,13.875L456.375,13.875ZM454.375,11.875L454.375,15.875Z" fill="#ffffff" stroke="#c2c2c2" stroke-width="1" style="fill: rgb(255, 255, 255); stroke: rgb(194, 194, 194);"></path><rect x="446.5" y="6.5" width="18" height="17" rx="2" ry="2" fill="#c0c0c0" stroke="#c0c0c0" fill-opacity="0.000001" stroke-opacity="0.000001" stroke-width="1" style="fill: rgb(192, 192, 192); stroke: rgb(192, 192, 192); fill-opacity: 0.001; stroke-opacity: 0.001; cursor: pointer;"></rect><rect x="446.5" y="6.5" opacity="1" stroke-opacity="1" fill="#cccccc" stroke-width="0" r="0" height="0.5" width="0.5" d="M 0 0 L 1 1" /></g></g><path d="M0,0" fill="none" stroke="none"  style="fill: none; stroke: none;"></path><path d="M0,0" fill="none" stroke="none"  style="fill: none; stroke: none;"></path><text x="6" y="396"  fill="#000000" stroke="#000000" stroke-width="0.2" text-anchor="start" style=" fill: rgb(0, 0, 0); text-anchor: start; fill-opacity: 0.5; font-size: 9px; font-family: verdana, sans; cursor: pointer;" fill-opacity="0.5" stroke-opacity="0.5"  font-size="9px" font-family="Verdana,sans"><tspan dy="-1.890625" x="6">FusionCharts XT Trial</tspan></text><rect x="44" y="46" width="0" height="0" rx="0" ry="0" fill="#00ff00" stroke="#ff0000" stroke-width="1" style="fill: rgb(0, 255, 0); stroke: rgb(255, 0, 0); opacity: 0.2; cursor: default;" opacity="0.2"></rect><rect opacity="1" stroke-opacity="1" fill="#cccccc" stroke-width="0" r="0" height="0.5" width="0.5" d="M 0 0 L 1 1" /></svg>'
	stream = stichImageToSVG(stream, '{"image_1":{"name":"temp_image_0","type":"png","encodedData":"data:image/png;base64,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","width":539,"height":304}}')
	convertSVGtoImageOrPdf(stream, "pdf")	
  end

  # this function purse the request and create the request Data object
  def parseRequestParams(request.POST)
  	
  end	

  # this function replaces the image href with image data
  def stichImageToSVG(svgString, imageData)
  	
  	imageDataArray = JSON.parse(imageData) # parsing the image data object
  	keys = imageDataArray.keys # holds the keys like image_1, image_2 etc  
  	matches = /xlink:href\s*=\s*"([^"]*)"/.match(svgString).captures # matches array holds the physical paths of images lies in the SVG
  	
  	# looping through all of the matches
  	matches.each do |match|
	    imageName = match.split("/").last.split(".").first
	    imageData = ""
		
		# looping through the images of json data	
		keys.each do |key|
	    	if imageDataArray[key]['name'] == imageName
	    		imageData = imageDataArray[key]['encodedData']
	    		break
	    	end	
		end
		svgString = svgString.sub(match, imageData); # replacing the image href with image data
	end

  	return svgString
	
  end	

  # This function coverts the provided SVG string to image or pdf file
  def convertSVGtoImageOrPdf(svgString, format)
  	img = Magick::Image.from_blob(svgString) {
	  self.format = 'SVG'
	}

	img[0].write("example_out"+"."+format)
  end	
end


# Installing rmagick in ubuntu
# => First, check that the universe repository is enabled by inspecting '/etc/apt/sources.list' with your favourite editor.

# => You will need to use sudo to ensure that you have permissions to edit the file.

# => If universe is not included then modify the file so that it does.

# => deb http://us.archive.ubuntu.com/ubuntu precise main universe
# => After any changes you should run this command to update your system.

# => sudo apt-get update
# => You can now install the package like this.

# => Install librmagick-ruby
# => sudo apt-get install librmagick-ruby

