# Dependencies to run the program
# 1> rmagick
# 2> json
require "RMagick" 
class FcExporterController < ApplicationController
  
  def pageLoad
  	streaml = '<svg height="300" version="1.1" width="400" xmlns="http://www.w3.org/2000/svg" id="raphael-paper-11" style="overflow: hidden; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); -webkit-user-select: none; cursor: default; position: relative; background-color: rgb(255, 255, 255);"><desc>Area Chart with caption "Sales of Liquor"</desc><defs><clipPath id="A85AB617-8DF4-4861-AA69-8CF64969397D"><rect x="72" y="57" width="313" height="194" transform="matrix(1,0,0,1,0,0)"></rect></clipPath></defs><g class="raphael-group-12-background"><rect x="0" y="0" width="400" height="300" stroke="none" fill-opacity="0.5" fill="#ffffff" rx="0" ry="0" style="stroke: none; fill-opacity: 0.5; fill: rgb(255, 255, 255);"></rect><rect x="0" y="0" width="400" height="300" stroke="#767575" stroke-opacity="0.5" stroke-width="0" stroke-dasharray="none" fill="none" rx="0" ry="0" style="stroke: rgb(118, 117, 117); stroke-opacity: 0.5; fill: none;"></rect></g><g class="raphael-group-19-canvas"><rect x="72" y="57" width="313" height="194" rx="0" ry="0" stroke-width="0" stroke="#545454" stroke-opacity="1" stroke-linejoin="miter" fill="none" style="stroke: rgb(84, 84, 84); stroke-opacity: 1; stroke-linejoin: miter; fill: none;"></rect><rect x="72" y="57" width="313" height="194" rx="0" ry="0" stroke-width="0" stroke="none" fill-opacity="1" fill="#ffffff" style="stroke: none; fill-opacity: 1; fill: rgb(255, 255, 255);"></rect></g><g class="raphael-group-22-axisbottom"><g class="raphael-group-25-x-axis-bands"></g><g class="raphael-group-31-y-axis-bands"><rect x="72" y="173.39999999999998" width="313" height="38.80000000000001" fill-opacity="0" fill="#eeeeee" stroke-width="0" rx="0" ry="0" stroke="#000000" style="fill-opacity: 0; fill: rgb(238, 238, 238); stroke: rgb(0, 0, 0);"></rect><rect x="72" y="95.79999999999998" width="313" height="38.80000000000001" fill-opacity="0" fill="#eeeeee" stroke-width="0" rx="0" ry="0" stroke="#000000" style="fill-opacity: 0; fill: rgb(238, 238, 238); stroke: rgb(0, 0, 0);"></rect></g><g class="raphael-group-37-y-axis-bands"></g><g class="raphael-group-27-x-axis-lines"></g><g class="raphael-group-33-y-axis-lines"><path d="M72,212.5L385,212.5" stroke="#717170" stroke-opacity="0.1" stroke-width="1" stroke-dasharray="none" fill="none" shape-rendering="crispEdges" style="stroke: rgb(113, 113, 112); stroke-opacity: 0.1; fill: none; shape-rendering: crispEdges;"></path><path d="M72,173.5L385,173.5" stroke="#717170" stroke-opacity="0.1" stroke-width="1" stroke-dasharray="none" fill="none" shape-rendering="crispEdges" style="stroke: rgb(113, 113, 112); stroke-opacity: 0.1; fill: none; shape-rendering: crispEdges;"></path><path d="M72,135.5L385,135.5" stroke="#717170" stroke-opacity="0.1" stroke-width="1" stroke-dasharray="none" fill="none" shape-rendering="crispEdges" style="stroke: rgb(113, 113, 112); stroke-opacity: 0.1; fill: none; shape-rendering: crispEdges;"></path><path d="M72,96.5L385,96.5" stroke="#717170" stroke-opacity="0.1" stroke-width="1" stroke-dasharray="none" fill="none" shape-rendering="crispEdges" style="stroke: rgb(113, 113, 112); stroke-opacity: 0.1; fill: none; shape-rendering: crispEdges;"></path><path d="M72,57.5L385,57.5" stroke="#717170" stroke-opacity="0.1" stroke-width="1" stroke-dasharray="none" fill="none" shape-rendering="crispEdges" style="stroke: rgb(113, 113, 112); stroke-opacity: 0.1; fill: none; shape-rendering: crispEdges;"></path></g><g class="raphael-group-39-y-axis-lines"></g><g class="fusioncharts-xaxis-0-gridlabels"><text class="fusioncharts-label" fill-opacity="1" fill="#555555" x="92" y="268" text-anchor="middle" transform="matrix(1,0,0,1,0,0)" stroke="none" style="fill-opacity: 1; fill: rgb(85, 85, 85); text-anchor: middle; stroke: none; font-family: Verdana, sans; font-size: 10px; font-weight: normal; font-style: normal;" font-family="Verdana,sans" font-size="10px" font-weight="normal" font-style="normal"><tspan dy="-2" x="92">Mon</tspan></text><text class="fusioncharts-label" fill-opacity="1" fill="#555555" x="138" y="268" text-anchor="middle" transform="matrix(1,0,0,1,0,0)" stroke="none" style="fill-opacity: 1; fill: rgb(85, 85, 85); text-anchor: middle; stroke: none; font-family: Verdana, sans; font-size: 10px; font-weight: normal; font-style: normal;" font-family="Verdana,sans" font-size="10px" font-weight="normal" font-style="normal"><tspan dy="-2" x="138">Tue</tspan></text><text class="fusioncharts-label" fill-opacity="1" fill="#555555" x="184" y="268" text-anchor="middle" transform="matrix(1,0,0,1,0,0)" stroke="none" style="fill-opacity: 1; fill: rgb(85, 85, 85); text-anchor: middle; stroke: none; font-family: Verdana, sans; font-size: 10px; font-weight: normal; font-style: normal;" font-family="Verdana,sans" font-size="10px" font-weight="normal" font-style="normal"><tspan dy="-2" x="184">Wed</tspan></text><text class="fusioncharts-label" fill-opacity="1" fill="#555555" x="230" y="268" text-anchor="middle" transform="matrix(1,0,0,1,0,0)" stroke="none" style="fill-opacity: 1; fill: rgb(85, 85, 85); text-anchor: middle; stroke: none; font-family: Verdana, sans; font-size: 10px; font-weight: normal; font-style: normal;" font-family="Verdana,sans" font-size="10px" font-weight="normal" font-style="normal"><tspan dy="-2" x="230">Thu</tspan></text><text class="fusioncharts-label" fill-opacity="1" fill="#555555" x="276" y="268" text-anchor="middle" transform="matrix(1,0,0,1,0,0)" stroke="none" style="fill-opacity: 1; fill: rgb(85, 85, 85); text-anchor: middle; stroke: none; font-family: Verdana, sans; font-size: 10px; font-weight: normal; font-style: normal;" font-family="Verdana,sans" font-size="10px" font-weight="normal" font-style="normal"><tspan dy="-2" x="276">Fri</tspan></text><text class="fusioncharts-label" fill-opacity="1" fill="#555555" x="322" y="268" text-anchor="middle" transform="matrix(1,0,0,1,0,0)" stroke="none" style="fill-opacity: 1; fill: rgb(85, 85, 85); text-anchor: middle; stroke: none; font-family: Verdana, sans; font-size: 10px; font-weight: normal; font-style: normal;" font-family="Verdana,sans" font-size="10px" font-weight="normal" font-style="normal"><tspan dy="-2" x="322">Sat</tspan></text><text class="fusioncharts-label" fill-opacity="1" fill="#555555" x="368" y="268" text-anchor="middle" transform="matrix(1,0,0,1,0,0)" stroke="none" style="fill-opacity: 1; fill: rgb(85, 85, 85); text-anchor: middle; stroke: none; font-family: Verdana, sans; font-size: 10px; font-weight: normal; font-style: normal;" font-family="Verdana,sans" font-size="10px" font-weight="normal" font-style="normal"><tspan dy="-2" x="368">Sun</tspan></text></g><g class="fusioncharts-yaxis-0-gridlabels"><text class="fusioncharts-label" fill="#555555" x="66" y="251" text-anchor="end" transform="matrix(1,0,0,1,0,0)" stroke="none" style="fill: rgb(85, 85, 85); text-anchor: end; stroke: none; font-family: Verdana, sans; font-size: 10px;" font-family="Verdana,sans" font-size="10px" font-weight="undefined" font-style="undefined"><tspan dy="4" x="66">$0</tspan></text><text class="fusioncharts-label" fill="#555555" x="66" y="212.2" text-anchor="end" transform="matrix(1,0,0,1,0,0)" stroke="none" style="fill: rgb(85, 85, 85); text-anchor: end; stroke: none; font-family: Verdana, sans; font-size: 10px;" font-family="Verdana,sans" font-size="10px" font-weight="undefined" font-style="undefined"><tspan dy="4.012499999999989" x="66">$1.4K</tspan></text><text class="fusioncharts-label" fill="#555555" x="66" y="173.39999999999998" text-anchor="end" transform="matrix(1,0,0,1,0,0)" stroke="none" style="fill: rgb(85, 85, 85); text-anchor: end; stroke: none; font-family: Verdana, sans; font-size: 10px;" font-family="Verdana,sans" font-size="10px" font-weight="undefined" font-style="undefined"><tspan dy="4.009374999999977" x="66">$2.8K</tspan></text><text class="fusioncharts-label" fill="#555555" x="66" y="134.6" text-anchor="end" transform="matrix(1,0,0,1,0,0)" stroke="none" style="fill: rgb(85, 85, 85); text-anchor: end; stroke: none; font-family: Verdana, sans; font-size: 10px;" font-family="Verdana,sans" font-size="10px" font-weight="undefined" font-style="undefined"><tspan dy="4.006249999999994" x="66">$4.2K</tspan></text><text class="fusioncharts-label" fill="#555555" x="66" y="95.79999999999998" text-anchor="end" transform="matrix(1,0,0,1,0,0)" stroke="none" style="fill: rgb(85, 85, 85); text-anchor: end; stroke: none; font-family: Verdana, sans; font-size: 10px;" font-family="Verdana,sans" font-size="10px" font-weight="undefined" font-style="undefined"><tspan dy="4.003124999999983" x="66">$5.6K</tspan></text><text class="fusioncharts-label" fill="#555555" x="66" y="57" text-anchor="end" transform="matrix(1,0,0,1,0,0)" stroke="none" style="fill: rgb(85, 85, 85); text-anchor: end; stroke: none; font-family: Verdana, sans; font-size: 10px;" font-family="Verdana,sans" font-size="10px" font-weight="undefined" font-style="undefined"><tspan dy="4" x="66">$7K</tspan></text></g><g class="fusioncharts-yaxis-1-gridlabels"></g><g class="raphael-group-42-axis-name"><text class="fusioncharts-yaxis-0-title" x="0" y="0" fill-opacity="1" fill="#555555" text-anchor="middle" style="fill-opacity: 1; fill: rgb(85, 85, 85); text-anchor: middle; font-size: 10px; stroke: none;" transform="matrix(0,-1,1,0,17,154)" font-size="10px" stroke="none"><tspan dy="10" x="0">Sales (In USD)</tspan></text><text class="fusioncharts-xaxis-0-title" x="0" y="0" fill-opacity="1" fill="#555555" text-anchor="middle" transform="matrix(1,0,0,1,228.5,273)" font-size="10px" stroke="none" style="fill-opacity: 1; fill: rgb(85, 85, 85); text-anchor: middle; font-size: 10px; stroke: none;"><tspan dy="10" x="0">Day</tspan></text></g><g class="raphael-group-65-axis-lines"><path d="M72,251.5L385,251.5" stroke="#000000" stroke-opacity="0.25" stroke-width="1" fill="none" style="stroke: rgb(0, 0, 0); stroke-opacity: 0.25; fill: none;"></path></g></g><g class="raphael-group-13-dataset"><g class="raphael-group-68-area" clip-path=""><path d="M92,251L92,136.73399999999998L138,122.59971428571427L184,98.37742857142857L230,114.92285714285714L276,97.76771428571428L322,90.17399999999998L368,79.11599999999999L368,251L322,251L276,251L230,251L184,251L138,251L92,251Z" fill="#0075c2" stroke="#0075c2" fill-opacity="0.5" stroke-dasharray="none" stroke-width="1" stroke-opacity="0.1" stroke-linecap="round" stroke-linejoin="miter" style="fill: rgb(0, 117, 194); stroke: rgb(0, 117, 194); fill-opacity: 0.5; stroke-opacity: 0.1; stroke-linecap: round; stroke-linejoin: miter;"></path></g><g class="raphael-group-69-area-connector"><g class="raphael-group-70-connector-shadow"></g><g class="raphael-group-71-anchor-shadow"></g><g class="raphael-group-72-connector"></g><g class="raphael-group-73-anchors"><path d="M89,136.73399999999998A3,3,0,0,0,95,136.73399999999998A3,3,0,0,0,89,136.73399999999998Z" fill="#ffffff" stroke="#0075c2" fill-opacity="0" stroke-width="1" stroke-opacity="0" style="fill: rgb(255, 255, 255); stroke: rgb(0, 117, 194); fill-opacity: 0; stroke-opacity: 0;"></path><path d="M135,122.59971428571427A3,3,0,0,0,141,122.59971428571427A3,3,0,0,0,135,122.59971428571427Z" fill="#ffffff" stroke="#0075c2" fill-opacity="0" stroke-width="1" stroke-opacity="0" style="fill: rgb(255, 255, 255); stroke: rgb(0, 117, 194); fill-opacity: 0; stroke-opacity: 0;"></path><path d="M181,98.37742857142857A3,3,0,0,0,187,98.37742857142857A3,3,0,0,0,181,98.37742857142857Z" fill="#ffffff" stroke="#0075c2" fill-opacity="0" stroke-width="1" stroke-opacity="0" style="fill: rgb(255, 255, 255); stroke: rgb(0, 117, 194); fill-opacity: 0; stroke-opacity: 0;"></path><path d="M227,114.92285714285714A3,3,0,0,0,233,114.92285714285714A3,3,0,0,0,227,114.92285714285714Z" fill="#ffffff" stroke="#0075c2" fill-opacity="0" stroke-width="1" stroke-opacity="0" style="fill: rgb(255, 255, 255); stroke: rgb(0, 117, 194); fill-opacity: 0; stroke-opacity: 0;"></path><path d="M273,97.76771428571428A3,3,0,0,0,279,97.76771428571428A3,3,0,0,0,273,97.76771428571428Z" fill="#ffffff" stroke="#0075c2" fill-opacity="0" stroke-width="1" stroke-opacity="0" style="fill: rgb(255, 255, 255); stroke: rgb(0, 117, 194); fill-opacity: 0; stroke-opacity: 0;"></path><path d="M319,90.17399999999998A3,3,0,0,0,325,90.17399999999998A3,3,0,0,0,319,90.17399999999998Z" fill="#ffffff" stroke="#0075c2" fill-opacity="0" stroke-width="1" stroke-opacity="0" style="fill: rgb(255, 255, 255); stroke: rgb(0, 117, 194); fill-opacity: 0; stroke-opacity: 0;"></path><path d="M365,79.11599999999999A3,3,0,0,0,371,79.11599999999999A3,3,0,0,0,365,79.11599999999999Z" fill="#ffffff" stroke="#0075c2" fill-opacity="0" stroke-width="1" stroke-opacity="0" style="fill: rgb(255, 255, 255); stroke: rgb(0, 117, 194); fill-opacity: 0; stroke-opacity: 0;"></path></g></g></g><g class="raphael-group-23-axistop"><g class="raphael-group-24-x-axis-bands"></g><g class="raphael-group-30-y-axis-bands"></g><g class="raphael-group-36-y-axis-bands"></g><g class="raphael-group-26-x-axis-lines"></g><g class="raphael-group-32-y-axis-lines"></g><g class="raphael-group-38-y-axis-lines"></g><g class="fusioncharts-xaxis-0-gridlabels"></g><g class="fusioncharts-yaxis-0-gridlabels"></g><g class="fusioncharts-yaxis-1-gridlabels"></g></g><g class="fusioncharts-datalabels" transform="matrix(1,0,0,1,0,0)"><text x="92" y="126.73399999999998" stroke="none" fill="#555555" text-anchor="middle" style="stroke: none; fill: rgb(85, 85, 85); text-anchor: middle; fill-opacity: 1; font-weight: normal; font-style: normal; font-family: Verdana, sans; font-size: 10px;" class="fusioncharts-label" fill-opacity="1" font-weight="normal" font-style="normal" font-family="Verdana,sans" font-size="10px"><tspan dy="4.0152499999999804" x="92">$4.12K</tspan></text><text x="138" y="112.59971428571427" stroke="none" fill="#555555" text-anchor="middle" style="stroke: none; fill: rgb(85, 85, 85); text-anchor: middle; fill-opacity: 1; font-weight: normal; font-style: normal; font-family: Verdana, sans; font-size: 10px;" class="fusioncharts-label" fill-opacity="1" font-weight="normal" font-style="normal" font-family="Verdana,sans" font-size="10px"><tspan dy="4.0059642857142705" x="138">$4.63K</tspan></text><text x="184" y="88.37742857142857" stroke="none" fill="#555555" text-anchor="middle" style="stroke: none; fill: rgb(85, 85, 85); text-anchor: middle; fill-opacity: 1; font-weight: normal; font-style: normal; font-family: Verdana, sans; font-size: 10px;" class="fusioncharts-label" fill-opacity="1" font-weight="normal" font-style="normal" font-family="Verdana,sans" font-size="10px"><tspan dy="4.002428571428567" x="184">$5.51K</tspan></text><text x="230" y="124.92285714285714" stroke="none" fill="#555555" text-anchor="middle" style="stroke: none; fill: rgb(85, 85, 85); text-anchor: middle; fill-opacity: 1; font-weight: normal; font-style: normal; font-family: Verdana, sans; font-size: 10px;" class="fusioncharts-label" fill-opacity="1" font-weight="normal" font-style="normal" font-family="Verdana,sans" font-size="10px"><tspan dy="4.00098214285714" x="230">$4.91K</tspan></text><text x="276" y="87.76771428571428" stroke="none" fill="#555555" text-anchor="middle" style="stroke: none; fill: rgb(85, 85, 85); text-anchor: middle; fill-opacity: 1; font-weight: normal; font-style: normal; font-family: Verdana, sans; font-size: 10px;" class="fusioncharts-label" fill-opacity="1" font-weight="normal" font-style="normal" font-family="Verdana,sans" font-size="10px"><tspan dy="4.002089285714277" x="276">$5.53K</tspan></text><text x="322" y="80.17399999999998" stroke="none" fill="#555555" text-anchor="middle" style="stroke: none; fill: rgb(85, 85, 85); text-anchor: middle; fill-opacity: 1; font-weight: normal; font-style: normal; font-family: Verdana, sans; font-size: 10px;" class="fusioncharts-label" fill-opacity="1" font-weight="normal" font-style="normal" font-family="Verdana,sans" font-size="10px"><tspan dy="4.002124999999978" x="322">$5.8K</tspan></text><text x="368" y="69.11599999999999" stroke="none" fill="#555555" text-anchor="middle" style="stroke: none; fill: rgb(85, 85, 85); text-anchor: middle; fill-opacity: 1; font-weight: normal; font-style: normal; font-family: Verdana, sans; font-size: 10px;" class="fusioncharts-label" fill-opacity="1" font-weight="normal" font-style="normal" font-family="Verdana,sans" font-size="10px"><tspan dy="4.0066249999999854" x="368">$6.2K</tspan></text></g><g class="raphael-group-96-caption"><text class="fusioncharts-caption" fill="#555555" x="228.5" y="15" text-anchor="middle" stroke="none" style="fill: rgb(85, 85, 85); text-anchor: middle; stroke: none; font-family: Verdana, sans; font-size: 14px; font-weight: bold;" font-family="Verdana,sans" font-size="14px" font-weight="bold"><tspan dy="13.890625" x="228.5">Sales of Liquor</tspan></text><text class="fusioncharts-subcaption" fill="#555555" x="228.5" y="33" text-anchor="middle" stroke="none" style="fill: rgb(85, 85, 85); text-anchor: middle; stroke: none; font-family: Verdana, sans; font-size: 14px; font-weight: normal;" font-family="Verdana,sans" font-size="14px" font-weight="normal"><tspan dy="13.90625" x="228.5">Last week</tspan></text></g><g class="raphael-group-14-hot"><g class="raphael-group-67-area-hot"><circle cx="92" cy="136.73399999999998" r="5" stroke="#c0c0c0" stroke-opacity="0.000001" stroke-width="1" fill-opacity="0.000001" fill="#c0c0c0" style="stroke: rgb(192, 192, 192); stroke-opacity: 1e-06; fill-opacity: 1e-06; fill: rgb(192, 192, 192);"></circle><circle cx="138" cy="122.59971428571427" r="5" stroke="#c0c0c0" stroke-opacity="0.000001" stroke-width="1" fill-opacity="0.000001" fill="#c0c0c0" style="stroke: rgb(192, 192, 192); stroke-opacity: 1e-06; fill-opacity: 1e-06; fill: rgb(192, 192, 192);"></circle><circle cx="184" cy="98.37742857142857" r="5" stroke="#c0c0c0" stroke-opacity="0.000001" stroke-width="1" fill-opacity="0.000001" fill="#c0c0c0" style="stroke: rgb(192, 192, 192); stroke-opacity: 1e-06; fill-opacity: 1e-06; fill: rgb(192, 192, 192);"></circle><circle cx="230" cy="114.92285714285714" r="5" stroke="#c0c0c0" stroke-opacity="0.000001" stroke-width="1" fill-opacity="0.000001" fill="#c0c0c0" style="stroke: rgb(192, 192, 192); stroke-opacity: 1e-06; fill-opacity: 1e-06; fill: rgb(192, 192, 192);"></circle><circle cx="276" cy="97.76771428571428" r="5" stroke="#c0c0c0" stroke-opacity="0.000001" stroke-width="1" fill-opacity="0.000001" fill="#c0c0c0" style="stroke: rgb(192, 192, 192); stroke-opacity: 1e-06; fill-opacity: 1e-06; fill: rgb(192, 192, 192);"></circle><circle cx="322" cy="90.17399999999998" r="5" stroke="#c0c0c0" stroke-opacity="0.000001" stroke-width="1" fill-opacity="0.000001" fill="#c0c0c0" style="stroke: rgb(192, 192, 192); stroke-opacity: 1e-06; fill-opacity: 1e-06; fill: rgb(192, 192, 192);"></circle><circle cx="368" cy="79.11599999999999" r="5" stroke="#c0c0c0" stroke-opacity="0.000001" stroke-width="1" fill-opacity="0.000001" fill="#c0c0c0" style="stroke: rgb(192, 192, 192); stroke-opacity: 1e-06; fill-opacity: 1e-06; fill: rgb(192, 192, 192);"></circle></g></g><g class="raphael-group-17-buttons"></g><text x="6" y="296" stroke="none" fill="#000000" text-anchor="start" style="stroke: none; fill: rgb(0, 0, 0); text-anchor: start; fill-opacity: 0.5; font-size: 9px; font-family: Verdana, sans; cursor: pointer;" fill-opacity="0.5" font-size="9px" font-family="Verdana,sans"><tspan dy="-1.890625" x="6">FusionCharts XT Trial</tspan></text></svg>'
	convertSVGtoImage(stream, "jpg")	
  end

  def stichImageToSVG(svgString, imageData)

  end	

  # This function coverts the provided SVG string to image
  def convertSVGtoImage(svgString, format)
  	

	img = Magick::Image.from_blob(svgString) {
	  self.format = 'SVG'
	}

	img[0].write("example_out"+"."+format)
  end	
end

# Installing rmagick in ubuntu
# => First, check that the universe repository is enabled by inspecting '/etc/apt/sources.list' with your favourite editor.

# => You will need to use sudo to ensure that you have permissions to edit the file.

# => If universe is not included then modify the file so that it does.

# => deb http://us.archive.ubuntu.com/ubuntu precise main universe
# => After any changes you should run this command to update your system.

# => sudo apt-get update
# => You can now install the package like this.

# => Install librmagick-ruby
# => sudo apt-get install librmagick-ruby

#Regex regex = new Regex("<image.+?xlink:href=\"(.+?)\".+?/?>");
        #int counter = 0;
        #foreach (Match match in regex.Matches(svgData))
        #{
         #   string[] temp1 = match.Value.Split(new string[] { "xlink:href=" }, StringSplitOptions.None);
          #  hrefArray.Add(temp1[1].Split('"')[1]);
          #  string[] imageNameArray = hrefArray[counter].Split('/');
          #  rawImageDataArray.Add(getImageData(data, imageNameArray[imageNameArray.Length - 1]));
          #  counter+=1;
        #}
